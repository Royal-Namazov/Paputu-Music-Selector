<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>INSTANT Music Player</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: white;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    button {
      background-color: #1DB954;
      border: none;
      color: white;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 30px;
      cursor: pointer;
      margin: 20px 0;
      font-weight: bold;
    }
    #nowPlaying {
      font-size: 24px;
      margin: 20px 0;
    }
    #timer {
      font-family: monospace;
      font-size: 20px;
    }
    .volume-control {
      margin: 20px auto;
      width: 200px;
    }
  </style>
</head>
<body>
  <h1>âš¡ INSTANT Music Player</h1>
  <button id="playButton">NEXT SEGMENT</button>
  <div id="nowPlaying">Loading...</div>
  <div id="timer">00:00 / 01:00</div>
  
  <div class="volume-control">
    <input type="range" id="volume" min="0" max="1" step="0.01" value="0.7">
  </div>

  <!-- Audio elements pool -->
  <audio id="player1"></audio>
  <audio id="player2"></audio>
  
  <script>
    // ULTRA-OPTIMIZED MUSIC PLAYER
    // Configuration
    const SEGMENT_LENGTH = 60; // 1 minute segments
    const TRACK_COUNT = 29; // Number of music tracks
    
    // DOM elements
    const playButton = document.getElementById('playButton');
    const nowPlaying = document.getElementById('nowPlaying');
    const timer = document.getElementById('timer');
    const volumeControl = document.getElementById('volume');
    
    // Audio elements
    const players = [
      document.getElementById('player1'),
      document.getElementById('player2')
    ];
    
    // State
    let currentPlayer = 0;
    let nextPlayer = 1;
    let currentTrack = 1;
    let currentSegment = 1;
    let totalSegments = 1;
    let timerInterval;
    let elapsed = 0;
    
    // Initialize
    function init() {
      // Set initial volume
      players.forEach(p => p.volume = volumeControl.value);
      volumeControl.addEventListener('input', () => {
        players.forEach(p => p.volume = volumeControl.value);
      });
      
      // Preload first track
      loadTrack(players[0], 1);
      
      // When first player is ready, start playing
      players[0].addEventListener('canplaythrough', () => {
        startPlayback(players[0]);
      }, { once: true });
      
      // Button handler
      playButton.addEventListener('click', () => {
        playNextSegment();
      });
    }
    
    // Core functions
    function loadTrack(player, trackNumber) {
      player.src = `music/music${trackNumber}.mp3`;
      player.load();
    }
    
    function startPlayback(player) {
      const duration = player.duration;
      totalSegments = Math.floor(duration / SEGMENT_LENGTH);
      currentSegment = 1;
      
      // Start at random position
      player.currentTime = Math.random() * (duration - SEGMENT_LENGTH);
      player.play();
      
      updateUI();
      
      // Start timer
      elapsed = 0;
      clearInterval(timerInterval);
      timerInterval = setInterval(updateTimer, 1000);
      
      // Preload next track in background
      const nextTrack = (currentTrack % TRACK_COUNT) + 1;
      loadTrack(players[nextPlayer], nextTrack);
    }
    
    function playNextSegment() {
      currentSegment++;
      
      if (currentSegment > totalSegments) {
        // Switch to next track
        switchPlayers();
        currentTrack = (currentTrack % TRACK_COUNT) + 1;
        startPlayback(players[currentPlayer]);
      } else {
        // Play next segment in current track
        const player = players[currentPlayer];
        const duration = player.duration;
        player.currentTime = Math.random() * (duration - SEGMENT_LENGTH);
        updateUI();
        elapsed = 0;
      }
    }
    
    function switchPlayers() {
      [currentPlayer, nextPlayer] = [nextPlayer, currentPlayer];
    }
    
    function updateUI() {
      nowPlaying.textContent = `Playing TRACK ${currentTrack} (Segment ${currentSegment}/${totalSegments})`;
    }
    
    function updateTimer() {
      elapsed++;
      timer.textContent = `${String(Math.floor(elapsed / 60)).padStart(2, '0')}:${String(elapsed % 60).padStart(2, '0')} / 01:00`;
      
      if (elapsed >= SEGMENT_LENGTH) {
        playNextSegment();
      }
    }
    
    // Start the player
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
